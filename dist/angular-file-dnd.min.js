(function(){"use strict";angular.module("omr.angularFileDnD",[]).directive("fileDropzone",function(){return{require:"^?form",restrict:"A",scope:!1,link:function(a,b,c,d){var e,f,g,h,i,j;return f=function(a){var b;return b=a.dataTransfer||a.originalEvent.dataTransfer},h=function(d){return a.$eval(c.dropzoneEnabled)?d&&(b.addClass(c.dropzoneHoverClass),d.preventDefault&&d.preventDefault(),d.stopPropagation)?!1:(f(d).effectAllowed="copy",!1):!0},c.dropzoneHoverClass=c.dropzoneHoverClass||"file-droping",j=c.fileDropzone,e=function(a){var b;return void 0===(b=c.maxFileSize)||""===b||a/1024/1024<c.maxFileSize?!0:(alert("File must be smaller than "+c.maxFileSize+" MB"),!1)},g=function(a){return void 0===j||""===j||j.indexOf(a)>-1?!0:(alert("Invalid file type.  File must be one of following types "+j),!1)},i=function(b,c){var d,e,f;return-1===b.indexOf(".")?a[b]=c:(e=b.split("."),d=e.slice(0,-1).join("."),f=e[e.length-1],a.$eval(d)[f]=c)},b.bind("dragover",h),b.bind("dragenter",h),b.bind("dragleave",function(){return b.removeClass(c.dropzoneHoverClass)}),b.bind("drop",function(h){var j,k,l,m,n;return a.$eval(c.dropzoneEnabled)?(null!=h&&h.preventDefault(),b.removeClass(c.dropzoneHoverClass),l=new FileReader,l.onload=function(b){return e(m)&&g(n)?(a.$apply(function(){return i(c.file,b.target.result),angular.isString(c.fileName)?i(c.fileName,k):void 0}),d&&d.$setDirty(),a.$emit("file-dropzone-drop-event",{file:a[c.file],type:n,name:k,size:m})):void 0},j=f(h).files[0],k=j.name,n=j.type,m=j.size,angular.isDefined(c.asFile)?(a.$apply(function(){return i(c.file,j),angular.isString(c.fileName)?i(c.fileName,k):void 0}),d&&d.$setDirty(),a.$emit("file-dropzone-drop-event",{file:j})):l.readAsDataURL(j),!1):!0})}}})}).call(this);